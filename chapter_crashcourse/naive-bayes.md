## Naive Bayes classification

Conditional independence is useful when dealing with data, since it simplifies a lot of equations.
A popular algorithm is the Naive Bayes Classifier.
The key assumption in it is that the attributes are all independent of each other, given the labels.
In other words, we have:

$$p(x|y) = \prod_i p(x_i|y)$$

Using Bayes Theorem this leads to the classifier $p(y|x) = \frac{\prod_i p(x_i|y) p(y)}{p(x)}$. Unfortunately, this is still intractable, since we don't know $p(x)$. Fortunately, we don't need it, since we know that $\sum_y p(y|x) = 1$, hence we can always recover the normalization from
$$p(y|x) \propto \prod_i p(x_i|y) p(y).$$
After all that math, it's time for some code to show how to use a Naive Bayes classifier for distinguishing digits on the MNIST classification dataset.

The problem is that we don't actually know $p(y)$ and $p(x_i|y)$. So we need to *estimate* it given some training data first. This is what is called *training* the model. In the case of 10 possible classes we simply compute $n_y$, i.e. the number of occurrences of class $y$ and then divide it by the total number of occurrences. E.g. if we have a total of 60,000 pictures of digits and digit 4 occurs 5800 times, we estimate its probability as $\frac{5800}{60000}$. Likewise, to get an idea of $p(x_i|y)$ we count how many times pixel $i$ is set for digit $y$ and then divide it by the number of occurrences of digit $y$. This is the probability that that very pixel will be switched on.

```{.python .input  n=1}
%matplotlib inline
from matplotlib import pyplot as plt
import mxnet as mx
from mxnet import nd
import numpy as np

# we go over one observation at a time (speed doesn't matter here)
def transform(data, label):
    return (nd.floor(data/128)).astype(np.float32), label.astype(np.float32)
mnist_train = mx.gluon.data.vision.MNIST(train=True, transform=transform)
mnist_test = mx.gluon.data.vision.MNIST(train=False, transform=transform)

# Initialize the count statistics for p(y) and p(x_i|y)
# We initialize all numbers with a count of 1 to ensure that we don't get a
# division by zero.  Statisticians call this Laplace smoothing.
ycount = nd.ones(shape=(10))
xcount = nd.ones(shape=(784, 10))

# Aggregate count statistics of how frequently a pixel is on (or off) for
# zeros and ones.
for data, label in mnist_train:
    x = data.reshape((784,))
    y = int(label)
    ycount[y] += 1
    xcount[:, y] += x

# normalize the probabilities p(x_i|y) (divide per pixel counts by total
# count)
for i in range(10):
    xcount[:, i] = xcount[:, i]/ycount[i]

# likewise, compute the probability p(y)
py = ycount / nd.sum(ycount)
```

Now that we computed per-pixel counts of occurrence for all pixels, it's time to see how our model behaves. Time to plot it. We show the estimated probabilities of observing a switched-on pixel. These are some mean looking digits.

```{.python .input  n=2}
import matplotlib.pyplot as plt
fig, figarr = plt.subplots(1, 10, figsize=(15, 15))
for i in range(10):
    figarr[i].imshow(xcount[:, i].reshape((28, 28)).asnumpy(), cmap='hot')
    figarr[i].axes.get_xaxis().set_visible(False)
    figarr[i].axes.get_yaxis().set_visible(False)

plt.show()
print(py)
```

```{.json .output n=2}
[
 {
  "data": {
   "image/png": "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\n",
   "text/plain": "<Figure size 1080x1080 with 10 Axes>"
  },
  "metadata": {
   "needs_background": "light"
  },
  "output_type": "display_data"
 },
 {
  "name": "stdout",
  "output_type": "stream",
  "text": "\n[0.09871688 0.11236461 0.09930012 0.10218297 0.09736711 0.09035161\n 0.09863356 0.10441593 0.09751708 0.09915014]\n<NDArray 10 @cpu(0)>\n"
 }
]
```

Now we can compute the likelihoods of an image, given the model. This is statistican speak for $p(x|y)$, i.e. how likely it is to see a particular image under certain conditions (such as the label). Since this is computationally awkward (we might have to multiply many small numbers if many pixels have a small probability of occurring), we are better off computing its logarithm instead. That is, instead of $p(x|y) = \prod_{i} p(x_i|y)$ we compute $\log p(x|y) = \sum_i \log p(x_i|y)$.

$$\begin{eqnarray}
l_y :=& \sum_i \log p(x_i|y) \\
 = & \sum_i x_i \log p(x_i = 1|y) + (1-x_i) \log \left(1-p(x_i=1|y)\right)
 \end{eqnarray}$$

To avoid recomputing logarithms all the time, we precompute them for all pixels.

```{.python .input  n=3}
logxcount = nd.log(xcount)
logxcountneg = nd.log(1-xcount)
logpy = nd.log(py)

fig, figarr = plt.subplots(2, 10, figsize=(15, 3))

# show 10 images
ctr = 0
for data, label in mnist_test:
    x = data.reshape((784,))
    y = int(label)

    # we need to incorporate the prior probability p(y) since p(y|x) is
    # proportional to p(x|y) p(y)
    logpx = logpy.copy()
    for i in range(10):
        # compute the log probability for a digit
        logpx[i] += nd.dot(logxcount[:, i], x) + nd.dot(logxcountneg[:, i], 1-x)
    # normalize to prevent overflow or underflow by subtracting the largest
    # value
    logpx -= nd.max(logpx)
    # and compute the softmax using logpx
    px = nd.exp(logpx).asnumpy()
    px /= np.sum(px)

    # bar chart and image of digit
    figarr[1, ctr].bar(range(10), px)
    figarr[1, ctr].axes.get_yaxis().set_visible(False)
    figarr[0, ctr].imshow(x.reshape((28, 28)).asnumpy(), cmap='hot')
    figarr[0, ctr].axes.get_xaxis().set_visible(False)
    figarr[0, ctr].axes.get_yaxis().set_visible(False)
    ctr += 1
    if ctr == 10:
        break

plt.show()
```

```{.json .output n=3}
[
 {
  "data": {
   "image/png": "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\n",
   "text/plain": "<Figure size 1080x216 with 20 Axes>"
  },
  "metadata": {
   "needs_background": "light"
  },
  "output_type": "display_data"
 }
]
```

As we can see, this classifier is both incompetent and overly confident of its incorrect estimates. That is, even if it is horribly wrong, it generates probabilities close to 1 or 0. Not a classifier we should use very much nowadays any longer. While Naive Bayes classifiers used to be popular in the 80s and 90s, e.g. for spam filtering, their heydays are over. The poor performance is due to the incorrect statistical assumptions that we made in our model: we assumed that each and every pixel are *independently* generated, depending only on the label. This is clearly not how humans write digits, and this wrong assumption led to the downfall of our overly naive (Bayes) classifier.
